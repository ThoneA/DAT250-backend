(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const o of e)if(o.type==="childList")for(const r of o.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&t(r)}).observe(document,{childList:!0,subtree:!0});function i(e){const o={};return e.integrity&&(o.integrity=e.integrity),e.referrerPolicy&&(o.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?o.credentials="include":e.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function t(e){if(e.ep)return;e.ep=!0;const o=i(e);fetch(e.href,o)}})();const l=document.getElementById("options-container"),m=document.getElementById("addOptionBtn"),f=document.getElementById("createPollBtn"),p=document.getElementById("voting-container"),c="http://localhost:8080/polls";m.addEventListener("click",()=>{const n=document.createElement("div");n.classList.add("option"),n.innerHTML=`
        <input type="text" class="option-input" placeholder="Enter option">
        <button class="removeOptionBtn">Remove</button>
    `,n.querySelector(".removeOptionBtn").addEventListener("click",()=>{l.removeChild(n)}),l.appendChild(n)});window.addEventListener("DOMContentLoaded",async()=>{p.innerHTML="";try{(await(await fetch(c)).json()).forEach(u)}catch{p.innerHTML="<p>Kunne ikke hente polls fra server.</p>"}});function u(n){const s=document.createElement("div");s.classList.add("single-poll");const i=document.createElement("h2");i.textContent=n.question,s.appendChild(i),n.options.forEach(t=>{const e=document.createElement("div");e.classList.add("vote-option");const o=document.createElement("span");o.textContent=t.caption;const r=document.createElement("span");r.textContent=` ${t.votes} ${t.votes===1?"Vote":"Votes"}`;const d=document.createElement("button");d.textContent="⬆️",d.addEventListener("click",async()=>{await fetch(`${c}/${n.id}/vote`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({optionId:t.id,delta:1})}),t.votes++,r.textContent=` ${t.votes} ${t.votes===1?"Vote":"Votes"}`});const a=document.createElement("button");a.textContent="⬇️",a.addEventListener("click",async()=>{t.votes>0&&(await fetch(`${c}/${n.id}/vote`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({optionId:t.id,delta:-1})}),t.votes--,r.textContent=` ${t.votes} ${t.votes===1?"Vote":"Votes"}`)}),e.appendChild(o),e.appendChild(d),e.appendChild(a),e.appendChild(r),s.appendChild(e)}),p.appendChild(s)}f.addEventListener("click",async()=>{const n=document.getElementById("pollQuestion"),s=document.querySelectorAll(".option-input"),i=[];if(s.forEach(t=>{t.value.trim()!==""&&i.push({caption:t.value.trim()})}),!n.value.trim()||i.length===0){alert("Du må skrive inn et spørsmål og minst ett alternativ!");return}try{const e=await(await fetch(c,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({question:n.value.trim(),options:i})})).json();u(e)}catch{alert("Kunne ikke opprette poll på serveren.")}n.value="",l.innerHTML=""});
